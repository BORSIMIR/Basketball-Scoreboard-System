<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basketball Scoreboard Control Panel</title>
    <link rel="stylesheet" href="./public/style.css">
    <link rel="stylesheet" href="./public/sweetalert2.min.css">
    <script src="./public/sweetalert2.min.js"></script>
</head>
<body class="scoreboard-control-panel">
    <div class="scoreboard">
        <div class="main-display">  
            <!-- Home Team -->
            <div class="team-section">
                <div class="team-name" onclick="editTeamName('home')">
                    <input type="text" id="home-name" value="" onchange="updateTeamNames()">
                </div>
                <div class="score" id="home-score">0</div>
                <div class="score-controls">
                    <button class="btn btn-success" onclick="adjustScore('home', 1)">+1</button>
                    <button class="btn btn-success" onclick="adjustScore('home', 2)">+2</button>
                    <button class="btn btn-success" onclick="adjustScore('home', 3)">+3</button>
                    <button class="btn btn-danger" onclick="adjustScore('home', -1)">-1</button>
                </div>
            </div>

            <!-- Clock Section -->
            <div class="clock-section">
                <div class="quarter-display" id="quarter">1st Quarter</div>
                <div class="game-clock" id="game-clock">10:00</div>
                <div class="clock-controls">
                    <button class="btn btn-primary" onclick="startGameClock()">Start</button>
                    <button class="btn btn-warning" onclick="pauseGameClock()">Pause</button>
                    <button class="btn btn-secondary" onclick="resetGameClock()">Reset</button>
                </div>
                <div class="time-adjustments">
                    <button class="btn btn-small btn-secondary" onclick="adjustGameTime(-1)">-1s</button>
                    <button class="btn btn-small btn-secondary" onclick="adjustGameTime(1)">+1s</button>
                    <button class="btn btn-small btn-secondary" onclick="adjustGameTime(-60)">-1m</button>
                    <button class="btn btn-small btn-secondary" onclick="adjustGameTime(60)">+1m</button>
                </div>
                
                <div class="shot-clock" id="shot-clock">24</div>
                <div class="clock-controls">
                    <button class="btn btn-primary" onclick="startShotClock()">Start</button>
                    <button class="btn btn-warning" onclick="pauseShotClock()">Pause</button>
                    <button class="btn btn-secondary" onclick="resetShotClock()">Reset</button>
                </div>
                <div class="time-adjustments">
                    <button class="btn btn-small btn-secondary" onclick="adjustShotTime(-1)">-1s</button>
                    <button class="btn btn-small btn-secondary" onclick="adjustShotTime(1)">+1s</button>
                    <button class="btn btn-small btn-secondary" onclick="setShotClock14()">14 Sec</button>
                </div>
            </div>

            <!-- Away Team -->
            <div class="team-section">
                <div class="team-name" onclick="editTeamName('away')">
                    <input type="text" id="away-name" value="" onchange="updateTeamNames()">
                </div>
                <div class="score" id="away-score">0</div>
                <div class="score-controls">
                    <button class="btn btn-success" onclick="adjustScore('away', 1)">+1</button>
                    <button class="btn btn-success" onclick="adjustScore('away', 2)">+2</button>
                    <button class="btn btn-success" onclick="adjustScore('away', 3)">+3</button>
                    <button class="btn btn-danger" onclick="adjustScore('away', -1)">-1</button>
                </div>
            </div>
        </div>

        <!-- Fouls Section -->
        <div class="fouls-section">
            <div class="foul-counter">
                <h3 id="home-foul-label">Home Team Fouls</h3>
                <div class="foul-count" id="home-fouls">0</div>
                <div class="score-controls">
                    <button class="btn btn-warning" onclick="adjustFouls('home', 1)">+1</button>
                    <button class="btn btn-danger" onclick="adjustFouls('home', -1)">-1</button>
                </div>
                <div class="timeout-counter">
                    <h4>Timeouts Remaining</h4>
                    <div class="timeout-count" id="home-timeouts">7</div>
                    <div class="timeout-buttons">
                        <button class="btn btn-warning btn-small" onclick="adjustTimeout('home', -1)">Timeout</button>
                        <button class="btn btn-secondary btn-small" onclick="adjustTimeout('home', 1)">+1</button>
                    </div>
                </div>
            </div>
            <div class="foul-counter">
                <h3 id="away-foul-label">Away Team Fouls</h3>
                <div class="foul-count" id="away-fouls">0</div>
                <div class="score-controls">
                    <button class="btn btn-warning" onclick="adjustFouls('away', 1)">+1</button>
                    <button class="btn btn-danger" onclick="adjustFouls('away', -1)">-1</button>
                </div>
                <div class="timeout-counter">
                    <h4>Timeouts Remaining</h4>
                    <div class="timeout-count" id="away-timeouts">7</div>
                    <div class="timeout-buttons">
                        <button class="btn btn-warning btn-small" onclick="adjustTimeout('away', -1)">Timeout</button>
                        <button class="btn btn-secondary btn-small" onclick="adjustTimeout('away', 1)">+1</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Controls -->
        <div class="game-controls">
            <button class="btn btn-large btn-warning" onclick="timeout()">Timeout</button>
            <button class="btn btn-large btn-secondary" onclick="substitution()">Substitution</button>
            <button class="btn btn-large btn-primary" onclick="nextQuarter()">Next Quarter</button>
            <button class="btn btn-large btn-danger" onclick="resetGame()">Reset Game</button>
            <button class="btn btn-large btn-primary" onclick="openScoreboard()">Open Scoreboard</button>
            <button class="btn btn-large btn-success" onclick="saveGameData()">Save Game Data</button>
        </div>
    </div>

    <audio id="buzzerSound" src="./public/basketball_buzzer_improved.mp3" preload="auto"></audio>
    <audio id="substitutionSound" src="./public/basketball_substitution_buzzer.mp3" preload="auto"></audio>

    <script src="./public/script.js"></script>
    <script>
        // Display updates for control panel
        function updateDisplay() {
            document.getElementById('home-score').textContent = gameState.homeScore;
            document.getElementById('away-score').textContent = gameState.awayScore;
            document.getElementById('home-fouls').textContent = gameState.homeFouls;
            document.getElementById('away-fouls').textContent = gameState.awayFouls;
            document.getElementById('home-timeouts').textContent = gameState.homeTimeouts;
            document.getElementById('away-timeouts').textContent = gameState.awayTimeouts;
            
            // Update quarter display
            const quarters = ['1st', '2nd', '3rd', '4th'];
            document.getElementById('quarter').textContent = `${quarters[gameState.quarter - 1]} Quarter`;
            
            // Update clock colors based on time
            const gameClock = document.getElementById('game-clock');
            const shotClock = document.getElementById('shot-clock');
            
            // Game clock display with milliseconds for last 10 seconds
            const showGameMilliseconds = gameState.gameTime <= 10;
            gameClock.textContent = formatTime(gameState.gameTime, showGameMilliseconds);
            
            // Shot clock display with milliseconds for last 5 seconds
            const showShotMilliseconds = gameState.shotTime <= 5;
            shotClock.textContent = formatShotClock(gameState.shotTime, showShotMilliseconds);
            
            // Game clock warnings
            if (gameState.gameTime <= 60) {
                gameClock.className = 'game-clock danger';
            } else if (gameState.gameTime <= 120) {
                gameClock.className = 'game-clock warning';
            } else {
                gameClock.className = 'game-clock';
            }
            
            // Shot clock warnings
            if (gameState.shotTime <= 5) {
                shotClock.className = 'shot-clock danger';
            } else if (gameState.shotTime <= 10) {
                shotClock.className = 'shot-clock warning';
            } else {
                shotClock.className = 'shot-clock';
            }
            
            // Update team names in foul counters
            document.getElementById('home-foul-label').textContent = `${gameState.homeName} Team Fouls`;
            document.getElementById('away-foul-label').textContent = `${gameState.awayName} Team Fouls`;
        }

        // Open scoreboard in new window
        function openScoreboard() {
            window.open('./public/scoreboard.html', 'scoreboard', 'width=1200,height=800,menubar=no,toolbar=no');
        }

        // Initialize
        updateDisplay();
    </script>
</body>
</html>